export async function avDaily(symbol,key,days=365){const u=new URL('https://www.alphavantage.co/query');u.searchParams.set('function','TIME_SERIES_DAILY_ADJUSTED');u.searchParams.set('symbol',symbol);u.searchParams.set('outputsize','full');u.searchParams.set('apikey',key);const { getJSON } = await import('./net.js'); const j = await getJSON(u.toString());const ts=j['Time Series (Daily)']||{};const rows=Object.entries(ts).map(([d,o])=>({t:d,o:+o['1. open'],h:+o['2. high'],l:+o['3. low'],c:+o['4. close'],v:+o['6. volume']})).sort((a,b)=>a.t.localeCompare(b.t)).slice(-days);return rows;}
export async function avQuote(symbol,key){const u=new URL('https://www.alphavantage.co/query');u.searchParams.set('function','GLOBAL_QUOTE');u.searchParams.set('symbol',symbol);u.searchParams.set('apikey',key);const { getJSON } = await import('./net.js'); const j = await getJSON(u.toString());const q=j['Global Quote']||null;if(!q)return null;return{price:+q['05. price'],change:+q['09. change']}};
